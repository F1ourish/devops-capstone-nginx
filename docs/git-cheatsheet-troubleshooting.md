# Git Cheatsheet (Troubleshooting)

## Содержание

[Быстрая диагностика "что происходит"](#1-быстрая-диагностика-что-происходит)

[Проблемы с авторизацией и доступом](#2-проблемы-с-авторизацией-и-доступом)

[rejected (fetch first)](#3-rejected-fetch-first)

[Конфликты (merge/rebase)](#4-конфликты-mergerebase)

[Rebase: продолжить/пропустить/отменить](#5-rebase-продолжить-пропустить-отменить)

[Detached HEAD](#6-detached-head)

["Не тот origin/не тот репозиторий"](#7-не-тот-origin-не-тот-репозиторий)

[Я случайно сломал историю](#8-я-случайно-сломал-историю)

[Полезные команды-спасатели](#9-полезные-команды-спасатели)

## 1) Быстрая диагностика “что происходит”

Цель: за 30 секунд понять, где ты находишься (ветка, remote, есть ли незакоммиченные изменения, что впереди/позади).

Команды:

* показать текущую ветку и статус

* посмотреть последние коммиты

* посмотреть remote

* понять, есть ли расхождение с origin (ahead/behind)

Подсказка: перед любыми “сложными” действиями сделай диагностику, чтобы не чинить вслепую.

## 2) Проблемы с авторизацией и доступом
### 2.1 GitHub: “Password authentication is not supported”

Смысл: по HTTPS нельзя использовать пароль аккаунта.
Решение:

* перейти на SSH remote, или

* использовать Personal Access Token (PAT) вместо пароля (если остаёшься на HTTPS).

Команды:

* посмотреть текущий remote

* переключить remote на SSH

### 2.2 SSH: “Permission denied (publickey)”

Причины:

* ключ не добавлен в GitHub

* ssh-agent не видит ключ

* remote указывает на SSH, но ключа нет/не тот

Команды:

* проверить SSH доступ

* посмотреть, какие ключи добавлены в агент

* добавить ключ в агент

### 2.3 “Repository not found”

Причины:

* неверное имя репозитория или username в remote URL

* репозиторий не создан на GitHub

* нет прав (приватный репо / другой владелец)

Команды:

* проверить remote URL

* поправить URL

## 3) rejected (fetch first)

Смысл: в remote есть коммиты, которых нет у тебя локально.

Решение (рекомендуемое): подтянуть изменения и переиграть свои поверх (rebase), затем push.

Команды:

* pull с rebase

* push

Если мешают незакоммиченные изменения:

* спрятать изменения (stash)

* pull

* вернуть изменения (stash pop)

## 4) Конфликты (merge/rebase)
### 4.1 Как понять, что конфликт

Признаки:

* Git пишет CONFLICT

* в файле появляются маркеры `<<<<<<<`, `=======`, `>>>>>>>`

### 4.2 Как решать конфликт (универсальный алгоритм)

   1. открыть конфликтный файл

   2. выбрать финальный вариант текста

   3. удалить маркеры конфликта

   4. сохранить

   5. отметить решённым: git add <file>

   6. продолжить процесс:

   * если rebase → git rebase --continue

   * если merge → git commit (или Git сам завершит merge, зависит от ситуации)

   * Подсказка: если конфликт в README при “add/add” — это обычно означает, что README был создан и локально, и на GitHub (как у нас было).

## 5) Rebase: продолжить / пропустить / отменить

Команды:

* продолжить: `git rebase --continue`

* пропустить проблемный коммит: `git rebase --skip`

* отменить и вернуть как было: `git rebase --abort`

Важно: rebase “переписывает” локальные коммиты (меняет хэши). Это нормально, пока коммиты не ушли в общий репозиторий.

## 6) Detached HEAD

Смысл: ты оказался “на коммите”, а не “на ветке” (часто после checkout конкретного хэша).

Как выйти:

* вернуться на ветку: `git switch main`

* или создать ветку из текущего состояния: `git switch -c <new-branch>`

## 7) Не тот origin / не тот репозиторий

Смысл: remote указывает не на тот репо (ошибка в имени или случайно привязал другой проект).

Команды:

* проверить: `git remote -v`

* исправить: `git remote set-url origin <правильный URL>`

## 8) Я случайно сломал историю

Быстрые сценарии:

* “сделал лишний коммит” → reset soft/hard

* “испорчил сообщение коммита” → amend

* “хочу вернуться к состоянию до rebase” → reflog (см. ниже)

Команды:
```bash
git commit --amend
git reset --soft HEAD~1
git reset --hard HEAD~1
```

## 9) Полезные команды-спасатели
### 9.1 git reflog

Показывает историю перемещений HEAD (помогает вернуть состояние после неудачных действий).
Команды:

* посмотреть reflog

* восстановиться на нужный state (через reset --hard на нужный reflog/commit)

### 9.2 git stash

Команды: `stash / list / pop`

### 9.3 git clean (осторожно)

Удаляет неотслеживаемые файлы.
Команды:

* “показать что удалит” (dry-run)

* удалить
